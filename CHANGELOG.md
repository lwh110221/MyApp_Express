# Express 后端项目开发日志

## [1.0.0] - 2024-12-10 至 2024-12-21

### 初始化阶段 (2024-12-10)
- 创建项目基础结构
- 实现用户登录功能
- 实现用户个人空间功能
  - 动态发布
  - 动态删除

### 用户认证增强 (2024-12-11)
#### 功能更新
- 添加验证码功能
  - 集成 `svg-captcha` 包
  - 创建验证码生成路由
  - 实现验证码验证逻辑
- 更新用户密码处理逻辑
- 添加会话管理
  - 集成 `express-session` 中间件
  - 配置会话安全选项

#### 安全性优化
- 移除硬编码的数据库凭证，改用环境变量
- 添加 Helmet 中间件增强安全性
- 增强会话配置
  - 添加 httpOnly 标志
  - 配置 sameSite 属性
- 实现请求速率限制，防止 DDoS 攻击
- 优化 CORS 配置
  - 实现动态 origin 检查
  - 从环境变量读取允许的源

#### 性能优化
- 添加 compression 中间件启用 gzip 压缩
- 配置静态文件缓存控制
- 优化数据库连接池配置
- 添加请求体大小限制

#### 错误处理优化
- 创建统一的错误处理中间件
- 添加详细的错误分类和响应
- 优化 404 处理逻辑

#### 日志系统
- 集成 Winston 日志系统
- 分离错误日志和普通日志
- 添加日志轮转和大小限制

### 图片功能优化 (2024-12-11)
- 修改 Helmet 配置
  - 设置 crossOriginResourcePolicy 为 cross-origin
  - 配置 contentSecurityPolicy 允许加载图片
- 优化静态文件服务
  - 添加跨域头
  - 配置缓存时间

### API 文档更新 (2024-12-21)
- 添加详细的请求/响应示例
- 完善错误处理文档
- 更新用户注册流程，集成验证码验证
- 优化版本控制策略

### 修改用户登录逻辑 （2024-12-28）
- 修改用户登录为邮箱登录


### 开发工具配置
- 添加 ESLint 和 Jest 支持
- 创建环境变量示例文件
- 优化 npm 脚本
- 配置 Git 忽略规则

## 当前技术栈
- Node.js & Express
- MySQL 数据库
- Winston 日志系统
- Express Session
- SVG Captcha
- Helmet 安全中间件
- Compression
- CORS 

# 更新日志

## [未发布]

### 新增
- 后台管理模块
  - 实现基于RBAC的权限管理系统
  - 添加管理员认证功能（登录、获取信息、修改密码）
  - 添加用户管理功能（列表、详情、状态管理、删除）
  - 添加用户统计功能
  - 实现操作日志记录
  - 添加权限验证中间件

### 数据库变更
- 新增管理员表 (`admins`)
- 新增角色表 (`roles`)
- 新增权限表 (`permissions`)
- 新增管理员-角色关联表 (`admin_roles`)
- 新增角色-权限关联表 (`role_permissions`)
- 新增操作日志表 (`admin_operation_logs`)

### 安全性改进
- 使用 JWT 进行管理员身份验证
- 实现基于角色的访问控制
- 密码加密存储
- 操作日志记录和追踪 